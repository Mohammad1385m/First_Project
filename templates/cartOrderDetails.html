{% load poll_extras %}

<div class="flex flex-col lg:flex-row px-4 md:px-20 mt-10 gap-5 pb-20">
    {% if cart.orderdetails_set.all %}
        <div class="lg:w-9/12 border border-zinc-200 rounded-xl divide-y divide-zinc-200">
            {% for order in cart.orderdetails_set.all %}
                <div class="mt-7 flex flex-col md:flex-row gap-y-5 p-4">
                    <div class="w-10/12 mx-auto max-w-52 md:max-w-36">
                        <img src="{{ order.product.main_image.url }}" alt="{{ order.product }}">
                    </div>
                    <div class="mr-2 md:mr-5 w-full flex flex-wrap gap-y-3">
                        <a href="{% url 'product_details' order.product.slug %}"
                           class="w-full h-fit md:w-9/12 text-sm sm:text-base text-zinc-700 mb-5">
                            {{ order.product.title }}
                        </a>
                        <div class="w-full md:w-3/12 flex justify-end">
                            <div class="text-gray-700">
                                <div class="quantity-container flex mr-auto h-10 w-24 items-center justify-between rounded-lg border border-gray-100 px-2 py-1">
                                    <a onclick="increase_quantity({{ order.product.id }})">
                                        <button class="cursor-pointer" type="button"
                                                data-action="increment">
                                            <svg class="fill-green-500" xmlns="http://www.w3.org/2000/svg"
                                                 width="18"
                                                 height="18" viewBox="0 0 256 256">
                                                <path d="M222,128a6,6,0,0,1-6,6H134v82a6,6,0,0,1-12,0V134H40a6,6,0,0,1,0-12h82V40a6,6,0,0,1,12,0v82h82A6,6,0,0,1,222,128Z"></path>
                                            </svg>
                                        </button>
                                    </a>
                                    <input value="{{ order.count }}" disabled type="number"
                                           class="flex h-5 w-full grow select-none items-center justify-center bg-transparent text-center text-sm text-zinc-700 outline-none">
                                    <a onclick="decrease_quantity({{ order.product.id }})">
                                        <button class="cursor-pointer" type="button"
                                                data-action="decrement">
                                            <svg class="fill-red-500" xmlns="http://www.w3.org/2000/svg"
                                                 width="18"
                                                 height="18"
                                                 viewBox="0 0 256 256">
                                                <path d="M222,128a6,6,0,0,1-6,6H40a6,6,0,0,1,0-12H216A6,6,0,0,1,222,128Z"></path>
                                            </svg>
                                        </button>
                                    </a>
                                </div>
                                <div class="flex mt-5">
                                    <div class="text-2xl md:text-3xl text-zinc-700">{{ order.count|total_price:order }}</div>
                                    <div class="-rotate-90 text-zinc-400 text-xs">
                                        تومان
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        <div class="lg:w-3/12 lg:pt-5 my-10 lg:my-0">
            <div class="flex justify-between items-center text-primary-500">
                <div class="">
                    جمع مبلغ نهایی
                </div>
                <div class="flex">
                    <div class="text-2xl md:text-4xl font-yekanBakhBold">{{ final_payable_price }}</div>
                    <div class="-rotate-90 text-xs">
                        تومان
                    </div>
                </div>
            </div>
            <div class="flex justify-between items-center text-zinc-600 mt-5">
                <div class="text-sm">
                    جمع مبلغ کل
                </div>
                <div class="flex">
                    <div class="md:text-xl">
                        <strike>{{ cart.orderdetails_set.all|final_total_price }}</strike></div>
                    <div class="-rotate-90 text-[0.6rem]">
                        تومان
                    </div>
                </div>
            </div>
            <a href=""
               class="block bg-primary-500 hover:bg-primary-400 text-white text-center mt-10 px-5 md:px-2.5 py-3 md:py-4 rounded-xl shadow-lg transition-all font-yekanBakhBold md:text-lg">
                ثبت و ادامه
            </a>
        </div>
    {% else %}
        <div class="flex flex-col justify-center items-center mx-auto">
            <div class="text-zinc-600 text-center mx-auto py-10 font-yekanBakhRegular text-xl md:text-3xl flex justify-center items-center gap-x-1">
                <img class="size-6 md:size-10" src="/static/assets/image/icons/cancel.svg" alt="empty cart">
                سبد خرید خالی است !
            </div>
            <a href=""
               class="group/edit bg-primary-500 hover:bg-primary-400 text-white px-5 py-3 rounded-lg shadow-lg transition-all">
                مشاهده محصولات پرتخفیف
            </a>
        </div>
    {% endif %}
</div>